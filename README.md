# TG Panel с aaPanel

## Описание
Полный набор скриптов для установки, настройки и управления TG Panel с aaPanel на Linux сервере. Включает установку всех необходимых компонентов, включая FFmpeg для обработки медиафайлов.

## Системные требования
- Ubuntu 18.04+ / Debian 9+
- Минимум 1 ГБ RAM
- Минимум 10 ГБ свободного места
- Чистый сервер (без установленных веб-серверов)
- Root доступ

## Компоненты установки

### Основные компоненты
- aaPanel (панель управления сервером)
- PHP 8.2 с необходимыми расширениями
- MySQL для базы данных
- Apache/Nginx (на выбор)

### Медиа компоненты
- FFmpeg для обработки медиафайлов:
  - Конвертация видео и аудио
  - Сжатие медиафайлов
  - Создание превью
  - Поддержка форматов:
    - Видео: H.264, VP8/VP9, WebM
    - Аудио: MP3, AAC, Vorbis
    - Изображения: JPEG, PNG, GIF

## Управление (manage.sh)
Единый интерфейс для управления всеми аспектами TG Panel:
```bash
chmod +x manage.sh
sudo ./manage.sh
```

### Возможности manage.sh:
1. Установка TG Panel и компонентов
2. Проверка установки
3. Оптимизация настроек
4. Создание резервных копий
5. Просмотр статуса служб
6. Просмотр логов
7. Перезапуск служб
8. Исправление прав доступа

## Отдельные скрипты

### 1. Установка (install.sh)
```bash
chmod +x install.sh
sudo ./install.sh
```
Устанавливает:
- aaPanel
- PHP 8.2
- MySQL
- FFmpeg
- Веб-сервер
- TG Panel

### 2. Проверка (check_installation.sh)
```bash
chmod +x check_installation.sh
sudo ./check_installation.sh
```
Проверяет:
- Компоненты системы
- FFmpeg и его кодеки
- Соединения
- Права доступа
- Конфигурацию

### 3. Оптимизация (optimize.sh)
```bash
chmod +x optimize.sh
sudo ./optimize.sh
```
- Оптимизирует PHP
- Настраивает MySQL
- Оптимизирует веб-сервер
- Устанавливает права

### 4. Резервное копирование (backup.sh)
```bash
chmod +x backup.sh
sudo ./backup.sh
```
Создает полную резервную копию:
- Файлов сайта
- Базы данных
- Конфигураций
- Сессий и кэша

## Работа с медиафайлами

### Возможности FFmpeg
- Конвертация видео в разные форматы
- Сжатие медиафайлов
- Создание превью
- Извлечение аудио
- Обработка изображений

### Поддерживаемые форматы
- Видео: MP4, WebM, AVI, MKV
- Аудио: MP3, WAV, AAC, OGG
- Изображения: JPEG, PNG, GIF, WebP

### Примеры использования FFmpeg
```bash
# Конвертация видео
ffmpeg -i input.mp4 -c:v libx264 -c:a aac output.mp4

# Создание превью
ffmpeg -i input.mp4 -ss 00:00:01 -vframes 1 preview.jpg

# Сжатие видео
ffmpeg -i input.mp4 -vf "scale=1280:-1" -c:v libx264 -crf 23 output.mp4

# Извлечение аудио
ffmpeg -i input.mp4 -vn -acodec libmp3lame output.mp3
```

## Мониторинг и обслуживание

### Проверка компонентов
```bash
# Проверка FFmpeg
ffmpeg -version

# Проверка кодеков
ffmpeg -codecs

# Проверка форматов
ffmpeg -formats
```

### Просмотр логов
- Логи установки
- Логи TG Panel
- Логи PHP и FFmpeg
- Логи MySQL

### Управление службами
- Проверка статуса
- Перезапуск служб
- Мониторинг работы

## Решение проблем

### Проблемы с FFmpeg
```bash
# Проверка установки
which ffmpeg
ffmpeg -version

# Проверка кодеков
ffmpeg -codecs | grep libx264
ffmpeg -codecs | grep libvpx
```

### Общие проблемы
- Проверка через manage.sh
- Просмотр логов
- Перезапуск служб
- Исправление прав

## Обновление
- aaPanel: через панель управления
- FFmpeg: через пакетный менеджер
- TG Panel: по инструкции
- Компоненты: через aaPanel

## Безопасность
- Регулярные бэкапы
- Мониторинг прав
- Обновление компонентов
- Проверка логов
